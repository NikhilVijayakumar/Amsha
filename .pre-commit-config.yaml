# Pre-commit hooks for Amsha - Enforcement of Coding Standards
# See https://pre-commit.com for more information
# Run manually: pre-commit run --all-files
# Install: pre-commit install

repos:
  # Basic code quality checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        name: Trim trailing whitespace
      - id: end-of-file-fixer
        name: Fix end of files
      - id: check-yaml
        name: Check YAML syntax
        exclude: ^examples/
      - id: check-json
        name: Check JSON syntax
      - id: check-added-large-files
        name: Check for large files
        args: ['--maxkb=1000']
      - id: check-merge-conflict
        name: Check for merge conflicts
      - id: check-case-conflict
        name: Check for case conflicts
      - id: mixed-line-ending
        name: Fix mixed line endings

  # Python-specific checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: check-ast
        name: Check Python AST
      - id: debug-statements
        name: Check for debugger statements

  # Type checking with mypy (CRITICAL for Protocol validation)
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.8.0
    hooks:
      - id: mypy
        name: Type check with mypy
        args: [--config-file=mypy.ini]
        additional_dependencies:
          - pydantic==2.11.9
          - types-PyYAML
        exclude: ^(tests/|examples/|venv/)

  # Code formatting with black
  - repo: https://github.com/psf/black
    rev: 24.2.0
    hooks:
      - id: black
        name: Format code with black
        language_version: python3.9
        exclude: ^(venv/|.venv/)

  # Import sorting
  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        name: Sort imports with isort
        args: ["--profile", "black"]
        exclude: ^(venv/|.venv/)

  # Linting with flake8
  - repo: https://github.com/pycqa/flake8
    rev: 7.0.0
    hooks:
      - id: flake8
        name: Lint with flake8
        args: ['--max-line-length=120', '--extend-ignore=E203,W503']
        exclude: ^(tests/|venv/|.venv/)

  # AI-Powered Architectural Review (The "Ultimate" Hook)
  - repo: local
    hooks:
      - id: ai-architecture-audit
        name: ðŸ¤– AI Architecture Audit
        entry: python scripts/ai_audit.py
        language: system
        pass_filenames: false
        stages: [commit]
        verbose: true
        # Only run if AGENTS.md exists and AI audit is enabled
        # Set SKIP_AI_AUDIT=1 to bypass this hook

# Global configuration
default_stages: [commit]
fail_fast: false
